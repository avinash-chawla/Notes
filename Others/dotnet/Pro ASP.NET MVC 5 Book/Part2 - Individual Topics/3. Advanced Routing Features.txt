
1. Intro

--> In the previous chapter, I showed you how to use the routing system to handle incoming URLs, but this is only part of the story. 
--> You also need to be able use your URL schema to generate outgoing URLs you can embed in your views, so that users can click links and submit forms back to your application in a way that will target the correct controller and action. 

--> In this chapter, I will show you different techniques for generating outgoing URLs, show you how to customize the routing system by replacing the standard MVC routing implementation classes and use the MVC Framework areas feature, which allows you to break a large and complex MVC application into manageable chucks. 

-------------------------------------------------------------------------------------

2. Chapter Summary

Generate an  a element with an outgoing URL 		Use the Html.ActionLink helper method 1–5, 9
Provide values for segment variables 			Pass an anonymous object to the ActionLink helper whose properties correspond to the segment variable names.
Define attributes for the a element			Pass an anonymous object to the ActionLink helper whose properties correspond to the attribute names

Generate an outgoing URL without the a element 		Use the Url.Action helper method
Generate a URL from a specific route			Specify the route name when calling the helper 

Create a custom URL matching and generation policy		Derive from the RouteBase class
Create a custom mapping between URLs and  action methods	Implement the IRouteHandler interface 22, 23

Break an application into sections				Create areas or apply the RouteArea attribute 24–27, 30
Resolve controller name ambiguity in areas 			Give priority to a controller namespace 

Prevent IIS and ASP.NET processing requests 		Use the RouteExistingFiles property 
for static files 
before they are passed to the routing system

Prevent the routing system from processing a request 	Use the IgnoreRoute method

-------------------------------------------------------------------------------------

3. Preparing for this Chapter

--> RouteConfig.cs

        public static void RegisterRoutes(RouteCollection routes) {
            routes.MapMvcAttributeRoutes();
            routes.MapRoute("MyRoute", "{controller}/{action}/{id}",
                new {
                    controller = "Home", action = "Index", id = UrlParameter.Optional
                });
        }


-------------------------------------------------------------------------------------

--> Adding the Optimization Package

--> Later in the chapter I describe the areas feature, which requires a new package be installed into the project. Enter the following command into the NuGet console:

Install-Package Microsoft.AspNet.Web.Optimization -version 1.1.0 -projectname UrlsAndRoutes

-------------------------------------------------------------------------------------

4. Generating Outgoing URLs in Views 

--> The simplest way to generate an outgoing URL in a view is to call the Html.ActionLink helper method 

    <div>
        @Html.ActionLink("This is an outgoing URL", "CustomVariable")
    </div>

--> The parameters to the ActionLink method are the text for the link and the name of the action method that the link should target.

--> The HTML that the ActionLink method generates is based on the current routing configuration
--> Equal to: <a href="/Home/CustomVariable">This is an outgoing URL</a>

-------------------------------------------------------------------------------------

--> The benefit of this approach is that it automatically responds to changes in the routing configuration. 
--> As a demonstration, I have changed the route defined and added a new route to the RouteConfig.cs file

-------------------------------------------------------------------------------------

--> RouteConfig.cs

public static void RegisterRoutes(RouteCollection routes) {
    routes.MapMvcAttributeRoutes();

    routes.MapRoute("NewRoute", "App/Do{action}",
        new { controller = "Home" });

    routes.MapRoute("MyRoute", "{controller}/{action}/{id}",
        new { controller = "Home", action = "Index",
            id = UrlParameter.Optional }); 
} 

--> The new route changes the URL schema for requests that target the Home controller. 
--> If you start the app, you will see that this change is reflected in the HTML that is generated by the ActionLink HTML helper method

<a href="/App/DoCustomVariable">This is an outgoing URL</a>

-------------------------------------------------------------------------------------

5. Targeting Other Controllers

--> The default version of the ActionLink method assumes that you want to target an action method in the same controller that has caused the view to be rendered. 
--> To create an outgoing URL that targets a different controller, you can use an overload that allows you to specify the controller name

    <div>
        @Html.ActionLink("This targets another controller", "Index", "Admin")
    </div>

-------------------------------------------------------------------------------------

--> The routing system includes routes that have been defined using the Route attribute when determining how to target a given action method. 
--> In Listing 16-5, you can see how I have changed the controller name in the ActionLink call so that it targets the Index action in the Customer controller.

    <div>
        @Html.ActionLink("This targets another controller", "Index", "Customer")
    </div>

--> The link that is generated is as follows: <a href="/Test">This targets another controller</a>

--> This corresponds to the Route attribute I applied to the Index action method in the Customer controller 

[Route("~/Test")] 
public ActionResult Index() {..}

-------------------------------------------------------------------------------------

6. Passing Extra Values

--> You can pass values for segment variables using an anonymous type, with properties representing the segments.

@Html.ActionLink("This is an outgoing URL", "CustomVariable", new { id = "Hello" })

--> I have supplied a value for a segment variable called id. If the application uses the route shown in Listing 16-3, then the following HTML will be rendered in the view:

<a href="/App/DoCustomVariable?id=Hello">This is an outgoing URL</a>

--> Notice that the value I supplied has been added as part of the query string to fit into the URL pattern described by the route. 
--> This is because there is no segment variable that corresponds to id in that route.

-------------------------------------------------------------------------------------

--> Adding id segment variable in RouteConfig file

    routes.MapRoute("MyRoute", "{controller}/{action}/{id}",
        new { controller = "Home", action = "Index", id = UrlParameter.Optional });

--> Start the application again and you will see that the call to the ActionLink helper method in the ActionName.cshtml view produces the following HTML element:

<a href="/Home/CustomVariable/Hello">This is an outgoing URL</a>

-------------------------------------------------------------------------------------

7. Specifying HTML Attributes

--> I have focused on the URL that the ActionLink helper method generates, but remember that the method generates a complete HTML anchor (a) element. 
--> I can set attributes for this element by providing an anonymous type whose properties correspond to the attributes I require. 

        @Html.ActionLink("This is an outgoing URL",
            "Index", "Home", null, new {
                id = "myAnchorID",
                @class = "myCSSClass"
            })


--> I created a new anonymous type that has id and class properties, and passed it as a parameter to the ActionLink method. 
--> I passed null for the additional segment variable values, indicating that I do not have any values to supply.

--> When this call to ActionLink is rendered, I get the following HTML:

<a class="myCSSClass" href="/" id="myAnchorID">This is an outgoing URL</a>


-------------------------------------------------------------------------------------

8. Generating Fully Qualified URLs in Links

--> All of the links that I have generated so far have contained relative URLs, but I can also use the ActionLink helper method to generate fully qualified URLs

        @Html.ActionLink("This is an outgoing URL", "Index", "Home",
            "https", "myserver.mydomain.com", " myFragmentName",
            new { id = "MyId" },
            new { id = "myAnchorID", @class = "myCSSClass" })

--> This is the ActionLink overload with the most parameters, and accepts values for the protocol (https, in the listing), the name of the target server (myserver.mydomain.com), and the URL fragment (myFragmentName).

--> When rendered in a view, the ActionLink helper generates the following HTML:

<a class="myCSSClass"
     href="https://myserver.mydomain.com/Home/Index/MyId#myFragmentName"
     id="myAnchorID">This is an outgoing URL</a>

--> I recommend using relative URLs wherever possible. 

-------------------------------------------------------------------------------------

9. Generating URLs (and Not Links)

--> The Html.ActionLink helper method generates complete HTML <a> elements, which is usually what is required when creating views, but there will be times when you want just a URL, without the surrounding HTML. 

--> In these circumstances, the Url.Action method can be used to generate just the URL and not the surrounding HTML.

@Url.Action("Index", "Home", new { id = "MyId" })

--> The Url.Action method works in the same way as the Html.ActionLink method, except that it generates only the URL. 
--> The overloaded versions of the method and the parameters they accept are the same for both methods, and you can do all of the things with Url.Action that I demonstrated with Html.ActionLink in the previous sections. 

--> Output: /Home/Index/MyId

-------------------------------------------------------------------------------------

10. Generating Outgoing URLs in Action Methods

--> Mostly, you will need to generate outgoing URLs in views, but there are times when you may need to do something similar inside an action method. 
--> This can be achieved using the same helper method used in the view

        public ViewResult MyActionMethod() {
            string myActionUrl = Url.Action("Index", new { id = "MyID" });
            string myRouteUrl = Url.RouteUrl(new { controller = "Home",
                action = "Index" });
            //... do something with URLs...
            return View();
        }

--> For the routing in the example app, the myActionUrl variable would be set to /Home/Index/MyID and the myRouteUrl variable would be set to /, which is consistent with the results that calling these helpers in a view  would produce.

-------------------------------------------------------------------------------------

--> A more common requirement is to redirect the client browser to another URL, which can be achieved by returning the result of calling the RedirectToAction method

public RedirectToRouteResult MyActionMethod() {
    return RedirectToAction("Index"); 
} 

-------------------------------------------------------------------------------------

--> If you want to send a redirect using a URL generated from just object properties, you can use the RedirectToRoute method, as shown in Listing 16-13. 
--> This method also returns a RedirectToRouteResult object and has exactly the same effect as calling the RedirectToAction method.

public RedirectToRouteResult MyActionMethod() {
    return RedirectToRoute(new { controller = "Home", action = "Index", id = "MyID" });
} 

-------------------------------------------------------------------------------------

11. Generating a URL from a Specific Route

--> In the previous examples, I left the routing system to select the route which will be used to generate a URL or a link.  
--> In this section, I will show you how to control this process and select specific routes. 

--> In Listing 16-14, I have changed the routing information in the RouteConfig.cs file to better demonstrate this feature.

public static void RegisterRoutes(RouteCollection routes) {
    routes.MapMvcAttributeRoutes();
    routes.MapRoute("MyRoute", "{controller}/{action}");
    routes.MapRoute("MyOtherRoute", "App/{action}", new { controller = "Home" }); } 


-------------------------------------------------------------------------------------

--> There are two routes in this configuration and I have specified names for both of these routes: MyRoute and MyOtherRoute. 
--> There are two reasons for naming your routes:

1. As a reminder of the purpose of the route
2. So that you can select a specific route to be used to generate an outgoing URL
 

-------------------------------------------------------------------------------------

--> @Html.ActionLink("Click me", "Index", "Customer")

--> The outgoing link would always be generated using MyRoute, as follows: <a href="/Customer/Index">Click me</a>

--> You can override the default route matching behavior by using the Html.RouteLink method, which lets you specify which route you want to use, as follows:
... 
@Html.RouteLink("Click me", "MyOtherRoute","Index", "Customer") ...

--> The result is that the link generated by the helper looks like this:

<a Length="8" href="/App/Index?Length=5">Click me</a>

-------------------------------------------------------------------------------------

--> You can also give names to the routes you define with the Route attribute.

[Route("Add/{user}/{id:int}", Name="AddRoute")] 
public string Create(string user, int id) {

-------------------------------------------------------------------------------------

12. Customizing the Routing System

--> You have seen how flexible and configurable the routing system is, but if it does not meet your requirements, you can customize the behavior. 
--> In this section, I will show you the two ways to do this.

-------------------------------------------------------------------------------------

13. Generating Outgoing URLs

--> To support outgoing URL generation, I need to implement the GetVirtualPath method in the LegacyRoute class.  
--> If the class is unable to generate a specific URL, I let the routing system know by returning null. 

--> Otherwise, I return an instance of the VirtualPathData class.  

-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------

15. Working With Areas

--> The MVC Framework supports organizing a Web application into areas, where each area represents a functional segment of the application, such as administration, billing, customer support, and so on. 

--> This is useful in a large project, where having a single set of folders for all of the controllers, views, and models, and it can become difficult to manage.
--> Each MVC area has its own folder structure, allowing you to keep everything separate. This makes it more obvious which project elements relate to each functional area of the application, helping multiple developers to work on the project without colliding with one another

-------------------------------------------------------------------------------------

16. Creating an Area

--> To add an area to the example MVC application, right-click the UrlsAndRoutes project item in the Solution Explorer window and select Add Area from the pop-up menu. --> Visual Studio will prompt you for the name of the area, as shown in Figure 16-6. In this case, I have specified an area called Admin. 

--> This is a pretty common area to create, because many Web applications need to separate the customer-facing and administration functions. 

--> Inside the Areas/Admin folder, you will see a mini-MVC project. There are folders called Controllers, Models, and Views. 
--> The first two are empty, but the Views folder contains a Shared folder

-------------------------------------------------------------------------------------

--> The Areas folder also contains a file called AdminAreaRegistration.cs, which defines the AdminAreaRegistration class

using System.Web.Mvc;
namespace UrlsAndRoutes.Areas.Admin {
    public class AdminAreaRegistration : AreaRegistration {
        public override string AreaName {
            get {
                return "Admin";
            }
        }
        public override void RegisterArea(AreaRegistrationContext context) {
            context.MapRoute(
                "Admin_default",
                "Admin/{controller}/{action}/{id}",
                new { action = "Index", id = UrlParameter.Optional }
            );
        }
    } 
}

--> The interesting part of this class is the RegisterArea method. As you can see from the listing, this method registers a route with the URL pattern Admin/{controller}/{action}/{id}.

-------------------------------------------------------------------------------------

--> I do not need to take any action to make sure that this registration method is called. Visual Studio added a statement to the Global.asax file that takes care of setting up areas when it created the project, 

        protected void Application_Start() {
            AreaRegistration.RegisterAllAreas();			// this line
            RouteConfig.RegisterRoutes(RouteTable.Routes);
        }

--> The call to the static AreaRegistration.RegisterAllAreas method causes the MVC Framework to go  through all of the classes in the application, find those that are derived from the AreaRegistration class and call  the RegisterArea method on each of them.

-------------------------------------------------------------------------------------

--> Note:

--> Do not change the order of the statements related to routing in the Application_Start method. 
--> If you call RegisterRoutes before AreaRegistration.RegisterAllAreas is called, then your routes will be defined before the area routes. 

--> Given that routes are evaluated in order, this will mean that requests for area controllers are likely to be matched against the wrong routes.

-------------------------------------------------------------------------------------

17. Populating an Area

--> I added a Home controller to the Admin area and prepare Index action method with view.
--> Navigate to /Admin/Home/Index, you will see the view that was added to the Admin area

-------------------------------------------------------------------------------------

18. Resolving the Ambiguous Controller Issue

--> If you navigate to the /Home/Index URL, you will see the error

--> When an area is registered, any routes that it defines are limited to the namespace associated with the area. This is how I was able to request /Admin/Home/Index
--> Routes defined in the RegisterRoutes method of RouteConfig.cs are not similarly restricted.

routes.MapRoute("MyRoute", "{controller}/{action}");

--> The route named MyRoute translates the incoming URL from the browser to the Index action on the Home controller. 
--> At that point, I get an error, because there are no namespace restrictions in place for this route and the MVC Framework can see two HomeController classes. 

--> To resolve this, I need to prioritize the main controller namespace in all of the routes which might lead to a conflict

    routes.MapRoute("MyRoute", "{controller}/{action}", null, new[] {"UrlsAndRoutes.Controllers"});

--> This change ensures that the controllers in the main project are given priority in resolving requests. 
--> Of course, if you want to give preference to the controllers in an area, you can do that instead.

-------------------------------------------------------------------------------------

19. Creating Areas with Attributes

--> You can also create areas by applying the RouteArea attribute to controller classes. 
--> You can see how I have assigned the action methods in the Customer controller to a new area called Services 

    [RouteArea("Services")]
    [RoutePrefix("Users")]
    public class CustomerController : Controller {..}

--> The RouteArea attribute moves all of the routes defined by the Route attribute into the specified area. 
--> The effect of this attribute combined with the RoutePrefix attribute means that to reach the Create action method, for example, I have to create a URL like this:

http://localhost:34855/Services/Users/Add/Adam/100

--> The RouteArea attribute doesn’t affect routes that are defined by the Route attribute but that start with ~/

	[Route("~/Test")]
        public ActionResult Index() {

-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------


